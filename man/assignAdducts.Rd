% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/assign_adducts.R
\name{assignAdducts}
\alias{assignAdducts}
\title{Assign Adduct Annotations to Mass Spectrometry Features}
\usage{
assignAdducts(
  rt,
  rt_h = 30,
  mz_h = 0.005,
  neutral_rules = c(`M + H` = 1.007276, `M + Na` = 22.989218, `M + NH4` = 18.033823,
    `2M + H` = 1.007276),
  includeMS1 = TRUE
)
}
\arguments{
\item{rt}{A data.frame with MS feature information. Must include:
- `mz`: mass-to-charge ratio
- `rt`: retention time
- `id`: a unique identifier}

\item{rt_h}{Numeric. Clustering height for retention time grouping. Default = 30.}

\item{mz_h}{Numeric. Clustering height for m/z grouping. Default = 0.005.}

\item{neutral_rules}{Named numeric vector. Maps adduct labels to neutral mass
correction values. Default includes H, Na, NH4, and 2M+H (dimer).}

\item{includeMS1}{Logical. If TRUE, directional MS1-based annotations are calculated
based on retention time + mass to charge group and known adduct values. Default is TRUE.}
}
\value{
A data.frame with added columns:
  - `rtGroup`, `mzGroup`: cluster assignments
  - `annotation`, `direction`: inferred adduct info
  - `Neutral`: estimated neutral mass
}
\description{
Clusters MS features by retention time and m/z, identifies related ions, and
annotates them with likely adducts or relationships. Also estimates neutral masses
based on annotation patterns and configurable correction rules.
}
